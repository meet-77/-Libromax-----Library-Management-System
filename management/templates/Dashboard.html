{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Library Management System</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 flex">

  <!-- Sidebar -->
  <aside class="w-64 bg-[#0f3558] text-white min-h-screen">
    <div class="flex items-center space-x-3 p-4 bg-white rounded-lg shadow-md m-3">
  <!-- Book Icon -->
  <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-blue-700" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
    <path stroke-linecap="round" stroke-linejoin="round" d="M12 20l9-5-9-5-9 5 9 5z" />
    <path stroke-linecap="round" stroke-linejoin="round" d="M12 12l9-5-9-5-9 5 9 5z" />
  </svg>

  <!-- Text -->
  <span class="text-2xl font-bold text-blue-900">LibroMax</span>
</div>
    <nav class="mt-6 space-y-2">
      <a href="{% url "dashboard" %}" class="flex items-center px-6 py-2 bg-blue-800 rounded-md">
        <span class="mr-2">üìä</span> Dashboard
      </a>
      <a href="{% url 'manage_books' %}" class="flex items-center px-6 py-2 hover:bg-blue-800 rounded-md">
        <span class="mr-2">üìö</span> Manage Books
      </a>
      <a href="{% url "manage_user" %}" class="flex items-center px-6 py-2 hover:bg-blue-800 rounded-md">
        <span class="mr-2">üë•</span> Manage Members
      </a>
      <a href="{% url "manage_authors" %}" class="flex items-center px-6 py-2 hover:bg-blue-800 rounded-md">
        <span class="mr-2">‚úçÔ∏è</span> Manage Authors
      </a>
      <a href="{% url "manage_borrowed" %}" class="flex items-center px-6 py-2 hover:bg-blue-800 rounded-md">
        <span class="mr-2">üè∑Ô∏è</span> Manage borrowed
      </a>
     
    </nav>
  </aside>

  <!-- Main Section -->
  <main class="flex-1 p-8">

    <!-- Header -->
    <div class="flex justify-between items-center mb-8">
      <div>
        <h1 class="text-2xl font-semibold">Welcome! Admin</h1>
        <p class="text-gray-500">JAN 01, 2025 | Monday, 12.00 PM</p>
      </div>
        <div class="flex items-center space-x-6">
          <div class="relative">
            <span class="absolute -top-2 -right-2 bg-red-500 text-xs text-white rounded-full px-1.5">6</span>
            <svg class="w-6 h-6 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V4a2 2 0 10-4 0v1.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" />
            </svg>
          </div>
         <div class="flex items-center space-x-3">
            <div>
            <a href="{% url 'logout' %}" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4">
              LogOut
            </a>

            </div>
          
          </div>
        </div>
    </div>

    <!-- Summary Cards -->
<div class="grid grid-cols-4 gap-4 mb-8">
  <div class="bg-white rounded-lg shadow p-4 text-center">
    <p class="text-gray-500">Total Books</p>
    <h2 class="text-3xl font-semibold text-blue-700">{{ total_books }}</h2>
  </div>
  {% comment %} <div class="bg-white rounded-lg shadow p-4 text-center">
    <p class="text-gray-500">Borrowed Books</p>
    <h2 class="text-3xl font-semibold text-blue-700">{{ borrowed_books }}</h2>
  </div>
  <div class="bg-white rounded-lg shadow p-4 text-center">
    <p class="text-gray-500">Overdue Books</p>
    <h2 class="text-3xl font-semibold text-red-500">{{ overdue_books }}</h2>
  </div> {% endcomment %}
  <div class="bg-white rounded-lg shadow p-4 text-center">
    <p class="text-gray-500">Total Members</p>
    <h2 class="text-3xl font-semibold text-blue-700">{{ total_members }}</h2>
  </div>
</div>


    <!-- Tabs -->
    <div class="bg-white p-4 rounded-lg shadow mb-6">
    <div class="flex space-x-6 border-b border-gray-200 pb-2 mb-4">
      <button class="tab-btn text-blue-600 font-medium border-b-2 border-blue-600" data-tab="overview">Overview</button>
      <button class="tab-btn text-gray-600 hover:text-blue-600" data-tab="add-book">Add New Book</button>
      <button class="tab-btn text-gray-600 hover:text-blue-600" data-tab="register-member">Register New Member</button>
      <button class="tab-btn text-gray-600 hover:text-blue-600" data-tab="new_author">new_author's</button>
      <button class="tab-btn text-gray-600 hover:text-blue-600" data-tab="borrowing-book">Borrowing Bookes
    </div>
    
      <div id="add-book" class="tab-content hidden">
        <h1 class="text-2xl font-semibold mb-4">Add a New Book</h1>
        <form method="POST" action="{% url 'add_books' %}" class="mb-6">
            {% csrf_token %}
            
            <label>Book Name:</label><br>
            <input type="text" name="Book_name" required class="border p-2 w-full"><br><br>

            <label>Book Summary:</label><br>
            <textarea name="Book_summary" required class="border p-2 w-full"></textarea><br><br>

            <label>Book Price:</label><br>
            <input type="number" name="Book_price" required class="border p-2 w-full"><br><br>

            <label>Author:</label><br>
            <select name="author" required class="border p-2 w-full">
                <option value="">Select an Author</option>
                {% for author in authors %}
                    <option value="{{ author.id }}">{{ author.Author_name }}</option>
                {% endfor %}
            </select><br><br>

            <button type="submit" class="bg-blue-700 text-white px-4 py-2 rounded">Add Book</button>
          </form>
        </div>

    <div id="overview" class="tab-content">
      <h2 class="text-2xl font-bold mb-6 text-gray-800">üìö Overdue Books</h2>

      <div class="overflow-x-auto">
        <table class="min-w-full border border-gray-200 rounded-lg shadow-md overflow-hidden">
          <thead class="bg-blue-100 border-b">
            <tr class="text-left text-gray-700 uppercase text-sm tracking-wider">
              <th class="px-6 py-3">Book Title</th>
              <th class="px-6 py-3">Author</th>
              <th class="px-6 py-3">Price</th>
              
            </tr>
          </thead>
          <tbody class="text-gray-700">
            {% for book in books %}
            <tr class="border-b hover:bg-blue-50 transition duration-200">
              <td class="px-6 py-3 font-medium">{{ book.Book_name }}</td>
              <td class="px-6 py-3">
                {% if book.author %}  
                  {{ book.author.Author_name }}
                {% else %}
                  <span class="text-red-500 font-semibold">‚Äî</span>
                {% endif %}
              </td>
              <td class="px-6 py-3 font-medium">‚Çπ{{ book.Book_price }}</td>
              
            </tr>
            {% empty %}
            <tr>
              <td colspan="6" class="text-center py-6 text-gray-500 italic">No books available</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>


    <div id="register-member" class="tab-content hidden">
      <div class="max-w-lg mx-auto mt-10 bg-white p-8 rounded-xl shadow-md">
        <h2 class="text-2xl font-semibold text-center text-gray-800 mb-6">Register New Member</h2>

        {% if messages %}
          {% for message in messages %}
            <div class="p-3 mb-4 rounded-lg text-center {% if message.tags == 'success' %}bg-green-100 text-green-700{% else %}bg-red-100 text-red-700{% endif %}">
              {{ message }}
            </div>
          {% endfor %}
        {% endif %}

        <form action="{% url 'register' %}" method="POST" class="space-y-4">
          {% csrf_token %}
          
          <!-- First Name -->
          <div>
            <label for="firstname" class="block text-sm font-medium text-gray-700 mb-1">First Name</label>
            <input type="text" id="firstname" name="firstname" required
                  class="w-full border border-gray-300 rounded-lg p-2.5 focus:ring-2 focus:ring-blue-500 focus:outline-none">
          </div>

          <!-- Last Name -->
          <div>
            <label for="lastname" class="block text-sm font-medium text-gray-700 mb-1">Last Name</label>
            <input type="text" id="lastname" name="lastname" required
                  class="w-full border border-gray-300 rounded-lg p-2.5 focus:ring-2 focus:ring-blue-500 focus:outline-none">
          </div>

          <!-- Username -->
          <div>
            <label for="username" class="block text-sm font-medium text-gray-700 mb-1">Username</label>
            <input type="text" id="username" name="username" required
                  class="w-full border border-gray-300 rounded-lg p-2.5 focus:ring-2 focus:ring-blue-500 focus:outline-none">
          </div>

          <!-- Password -->
          <div>
            <label for="password" class="block text-sm font-medium text-gray-700 mb-1">Password</label>
            <input type="password" id="password" name="password" required
                  class="w-full border border-gray-300 rounded-lg p-2.5 focus:ring-2 focus:ring-blue-500 focus:outline-none">
          </div>

          <!-- Submit -->
          <div>
            <input type="submit" value="Register"
                  class="w-full bg-blue-600 text-white py-2.5 rounded-lg font-semibold hover:bg-blue-700 transition duration-200 cursor-pointer">
          </div>
        </form>
      </div>
    </div>
 
    <div id="new_author" class=" tab-content hidden max-w-2xl mx-auto bg-white shadow-lg rounded-lg p-6">
        <h1 class="text-2xl font-semibold mb-4 text-center">Add a New Author</h1>
        
        <form method="POST" action="{% url 'add_author' %}" class="mb-6">
          {% csrf_token %}
          
          <label class="block font-medium">Author Name:</label>
          <input type="text" name="Author_name" required class="border p-2 w-full rounded mb-3">

          <label class="block font-medium">Author Bio:</label>
          <textarea name="Author_bio" required class="border p-2 w-full rounded mb-3"></textarea>

          <label class="block font-medium">Date of Birth:</label>
          <input type="date" name="Date_of_birth" required class="border p-2 w-full rounded mb-3">

          <label class="block font-medium">Country:</label>
          <input type="text" name="country" required class="border p-2 w-full rounded mb-3">

          <button type="submit" class="bg-blue-700 text-white px-4 py-2 rounded hover:bg-blue-800">Add Author</button>
        </form>

          {% if messages %}
            <ul class="mb-4">
              {% for message in messages %}
                <li class="text-green-600 font-semibold">{{ message }}</li>
              {% endfor %}
            </ul>
          {% endif %}

          {% comment %} <h2 class="text-xl font-semibold mb-2 border-b pb-2">Authors List</h2>
          <ul class="space-y-2">
            {% for a in authors %}
              <li class="p-2 border rounded bg-gray-100">
                <strong>{{ a.Author_name }}</strong><br>
                <span class="text-sm text-gray-700">{{ a.Author_bio|truncatechars:80 }}</span><br>
                <span class="text-gray-600 text-sm">{{ a.Date_of_birth }} | {{ a.country }}</span>
              </li>
            {% empty %}
              <li class="text-gray-500">No authors added yet.</li>
            {% endfor %}
          </ul> {% endcomment %}
    </div>

  <div  id="borrowing-book" class=" tab-content hidden bg-white shadow-lg rounded-2xl w-full max-w-lg py-10 m-auto  ">
    <h2 class="text-2xl font-semibold text-center text-gray-800 mb-6">üìö Add Borrowing</h2>

    <form action="{% url 'add_borrowing' %}" method="POST" class="space-y-5">
      {% csrf_token %}

      <!-- User Name -->
      <div>
        <label for="user" class="block text-gray-700 font-medium mb-1">User Name</label>
        <select name="user" id="user" required
                class="border border-gray-300 p-2 w-full rounded-md focus:ring-2 focus:ring-blue-500 focus:outline-none">
          <option value="">Select User Name</option>
          {% for user in users %}
            <option value="{{ user.id }}">{{ user.username }}</option>
          {% empty %}
            <option disabled>No users found</option>
          {% endfor %}
        </select>
      </div>

      <!-- Book Name -->
      <div>
        <label for="book" class="block text-gray-700 font-medium mb-1">Book Name</label>
        <select name="book" id="book" required
                class="border border-gray-300 p-2 w-full rounded-md focus:ring-2 focus:ring-blue-500 focus:outline-none">
          <option value="">Select Book Name</option>
          {% for book in books %}
            <option value="{{ book.id }}">{{ book.Book_name }}</option>
          {% endfor %}
        </select>
      </div>

      <!-- Due Date -->
      <div>
        <label for="due_date_input" class="block text-gray-700 font-medium mb-1">Due Date</label>
        <input type="date" name="due_date" id="due_date_input" required
               class="border border-gray-300 p-2 w-full rounded-md focus:ring-2 focus:ring-blue-500 focus:outline-none">
      </div>

      <!-- Returned Date -->
      <div>
        <label for="return_date_input" class="block text-gray-700 font-medium mb-1">Returned Date</label>
        <input type="date" name="return_date" id="return_date_input"
               class="border border-gray-300 p-2 w-full rounded-md focus:ring-2 focus:ring-blue-500 focus:outline-none">
      </div>

      <!-- Status -->
      <div>
        <label for="status" class="block text-gray-700 font-medium mb-1">Status</label>
        <select name="status" id="status"
                class="border border-gray-300 p-2 w-full rounded-md focus:ring-2 focus:ring-blue-500 focus:outline-none">
          <option value="borrowed">Borrowed</option>
          <option value="returned">Returned</option>
          <option value="lost">Lost</option>
        </select>
      </div>

      <!-- Submit Button -->
      <div class="pt-4">
        <button type="submit"
                class="w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 rounded-lg transition duration-200">
          ‚ûï Add Borrowing
        </button>
      </div>
    </form>
  </div>
    </div>

       
        
  
  </main>
  
  <script>
    const tabs = document.querySelectorAll(".tab-btn");
    const contents = document.querySelectorAll(".tab-content");

    tabs.forEach(tab => {
      tab.addEventListener("click", () => {
        // Remove active classes
        tabs.forEach(t => t.classList.remove("text-blue-600", "border-b-2", "border-blue-600"));
        tabs.forEach(t => t.classList.add("text-gray-600"));

        // Hide all content
        contents.forEach(c => c.classList.add("hidden"));

        // Activate clicked tab
        tab.classList.add("text-blue-600", "border-b-2", "border-blue-600");
        tab.classList.remove("text-gray-600");

        // Show corresponding content
        const activeTab = tab.getAttribute("data-tab");
        document.getElementById(activeTab).classList.remove("hidden");
      });
    });
  </script>

</body>
</html>
